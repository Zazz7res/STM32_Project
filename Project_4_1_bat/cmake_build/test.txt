
Qwen3-Max
ä½ çŽ°åœ¨æ˜¯ä¸€åé«˜çº§åµŒå…¥å¼ä¸“å®¶  ç†Ÿæ‚‰windons linuxåŒç«¯å¼€å‘  ç„¶åŽæˆ‘çŽ°åœ¨æœ‰ä¸€ä¸ªé¡¹ç›®æ˜¯  windons keil5 å¼€å‘çš„ å·²è·‘é€š  ç„¶åŽæˆ‘çŽ°åœ¨è¦æ±‚ä½ å¸®æˆ‘æ”¹é€ æˆ  linux  cmake  ninja å¯ä»¥æˆåŠŸç¼–è¯‘çƒ§å½•çš„é¡¹ç›®  ä»¥ä¸‹æ˜¯è¿™ä¸ªé¡¹ç›®çš„æ–‡ä»¶ç»“æž„  mini-harry@hypower:~/STM32_Project/Project_4_1$ ls -R
.:
4-1-OLED-display  Hardware  Listings  STM32F103C8T6.ld	System	cmake
CMakeLists.txt	  Library   Objects   Start		User	startup_stm32f10x_md_gcc.s

./4-1-OLED-display:
Hardware  Listings  Project.uvguix.Admin  Project.uvprojx  System  keilkill.bat
Library	  Objects   Project.uvoptx	  Start		   User

./4-1-OLED-display/Hardware:
Key.c  Key.h  LED.c  LED.h  OLED.c  OLED.h  OLED_Font.h

./4-1-OLED-display/Library:
misc.c		 stm32f10x_crc.c     stm32f10x_flash.c	stm32f10x_pwr.c	  stm32f10x_tim.c
misc.h		 stm32f10x_crc.h     stm32f10x_flash.h	stm32f10x_pwr.h	  stm32f10x_tim.h
stm32f10x_adc.c	 stm32f10x_dac.c     stm32f10x_fsmc.c	stm32f10x_rcc.c	  stm32f10x_usart.c
stm32f10x_adc.h	 stm32f10x_dac.h     stm32f10x_fsmc.h	stm32f10x_rcc.h	  stm32f10x_usart.h
stm32f10x_bkp.c	 stm32f10x_dbgmcu.c  stm32f10x_gpio.c	stm32f10x_rtc.c	  stm32f10x_wwdg.c
stm32f10x_bkp.h	 stm32f10x_dbgmcu.h  stm32f10x_gpio.h	stm32f10x_rtc.h	  stm32f10x_wwdg.h
stm32f10x_can.c	 stm32f10x_dma.c     stm32f10x_i2c.c	stm32f10x_sdio.c
stm32f10x_can.h	 stm32f10x_dma.h     stm32f10x_i2c.h	stm32f10x_sdio.h
stm32f10x_cec.c	 stm32f10x_exti.c    stm32f10x_iwdg.c	stm32f10x_spi.c
stm32f10x_cec.h	 stm32f10x_exti.h    stm32f10x_iwdg.h	stm32f10x_spi.h

./4-1-OLED-display/Listings:

./4-1-OLED-display/Objects:

./4-1-OLED-display/Start:
core_cm3.c		   startup_stm32f10x_ld.s     stm32f10x.h
core_cm3.h		   startup_stm32f10x_ld_vl.s  system_stm32f10x.c
startup_stm32f10x_cl.s	   startup_stm32f10x_md.s     system_stm32f10x.h
startup_stm32f10x_hd.s	   startup_stm32f10x_md_vl.s
startup_stm32f10x_hd_vl.s  startup_stm32f10x_xl.s

./4-1-OLED-display/System:
Delay.c	 Delay.h

./4-1-OLED-display/User:
main.c	stm32f10x_conf.h  stm32f10x_it.c  stm32f10x_it.h

./Hardware:
Key.c  Key.h  LED.c  LED.h  OLED.c  OLED.h  OLED_Font.h

./Library:
misc.c		 stm32f10x_crc.c     stm32f10x_flash.c	stm32f10x_pwr.c	  stm32f10x_tim.c
misc.h		 stm32f10x_crc.h     stm32f10x_flash.h	stm32f10x_pwr.h	  stm32f10x_tim.h
stm32f10x_adc.c	 stm32f10x_dac.c     stm32f10x_fsmc.c	stm32f10x_rcc.c	  stm32f10x_usart.c
stm32f10x_adc.h	 stm32f10x_dac.h     stm32f10x_fsmc.h	stm32f10x_rcc.h	  stm32f10x_usart.h
stm32f10x_bkp.c	 stm32f10x_dbgmcu.c  stm32f10x_gpio.c	stm32f10x_rtc.c	  stm32f10x_wwdg.c
stm32f10x_bkp.h	 stm32f10x_dbgmcu.h  stm32f10x_gpio.h	stm32f10x_rtc.h	  stm32f10x_wwdg.h
stm32f10x_can.c	 stm32f10x_dma.c     stm32f10x_i2c.c	stm32f10x_sdio.c
stm32f10x_can.h	 stm32f10x_dma.h     stm32f10x_i2c.h	stm32f10x_sdio.h
stm32f10x_cec.c	 stm32f10x_exti.c    stm32f10x_iwdg.c	stm32f10x_spi.c
stm32f10x_cec.h	 stm32f10x_exti.h    stm32f10x_iwdg.h	stm32f10x_spi.h

./Listings:

./Objects:

./Start:
core_cm3.h		   startup_stm32f10x_ld.s     startup_stm32f10x_xl.s
startup_stm32f10x_cl.s	   startup_stm32f10x_ld_vl.s  stm32f10x.h
startup_stm32f10x_hd.s	   startup_stm32f10x_md.s     system_stm32f10x.c
startup_stm32f10x_hd_vl.s  startup_stm32f10x_md_vl.s  system_stm32f10x.h

./System:
Delay.c	 Delay.h

./User:
main.c	stm32f10x_conf.h  stm32f10x_it.c  stm32f10x_it.h

./cmake:
arm-none-eabi.cmake
mini-harry@hypower:~/STM32_Project/Project_4_1$ 

è®¾è®¡ä¸€ä¸ªå¯ä»¥å¤åˆ¶ç²˜è´´åˆ°ç»ˆç«¯è¿è¡Œçš„è„šæœ¬æ¥èŽ·å–ä½ éœ€è¦çš„é¡¹ç›®æ–‡ä»¶å†…å®¹  ç„¶åŽæ‰€ä»¥çš„å†…å®¹ä¿¡æ¯å¯¼å…¥åˆ°ä¸€ä¸ª.txtæ–‡ä»¶  ç„¶åŽæˆ‘æŠŠè¿™ä¸ª.txtæ–‡ä»¶å‘é€ç»™ä½   ä»¥ç¡®ä¿ä¿¡æ¯å¯¹é½

å·²å®Œæˆæ€è€ƒ
ä½œä¸ºåµŒå…¥å¼ä¸“å®¶ï¼Œæˆ‘å°†ä¸ºæ‚¨è®¾è®¡ä¸€ä¸ªå®‰å…¨ã€é«˜æ•ˆã€ç»“æž„åŒ–çš„è¯Šæ–­è„šæœ¬ï¼Œç”¨äºŽå®Œæ•´æ•èŽ·é¡¹ç›®å…³é”®ä¿¡æ¯ã€‚è¯¥è„šæœ¬ä¼šï¼š
âœ… ä»…æ”¶é›†æ–‡æœ¬æºç /é…ç½®æ–‡ä»¶ï¼ˆæŽ’é™¤äºŒè¿›åˆ¶/Keilä¸“æœ‰æ–‡ä»¶ï¼‰
âœ… ä¿ç•™å®Œæ•´ç›®å½•ç»“æž„ä¸Šä¸‹æ–‡
âœ… è‡ªåŠ¨æ£€æµ‹å·¥å…·é“¾çŽ¯å¢ƒä¿¡æ¯
âœ… è¾“å‡ºä¸ºå•æ–‡ä»¶ä¾¿äºŽä¼ è¾“åˆ†æž
âœ… åŒ…å«é˜²è¯¯æ“ä½œä¿æŠ¤ï¼ˆä¸ä¼šä¿®æ”¹/åˆ é™¤ä»»ä½•æ–‡ä»¶ï¼‰
ðŸ”§ ä¸€é”®è¯Šæ–­è„šæœ¬ï¼ˆå¤åˆ¶åˆ°ç»ˆç«¯æ‰§è¡Œï¼‰
bash
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120
ðŸ“Œ ä½¿ç”¨è¯´æ˜Ž
bash
123456789
ðŸ” è„šæœ¬è¾“å‡ºç¤ºä¾‹ç»“æž„
12345678
ðŸ’¡ é‡è¦æç¤ºï¼šæ ¹æ®æ‚¨åŽ†å²è®°å½•ï¼ŒOLEDä¸äº®é—®é¢˜å¸¸å› ç¼ºå°‘PA11/PA12é˜²ç –ä»£ç å¯¼è‡´ï¼ˆSTM32F103C8T6çš„USBå¼•è„šï¼‰ã€‚è¿ç§»æ—¶æˆ‘ä¼šåœ¨main()å¼€å¤´è‡ªåŠ¨æ³¨å…¥æ­¤ä¿æŠ¤ä»£ç ã€‚
è¯·æ‰§è¡Œè„šæœ¬åŽå°†ç”Ÿæˆçš„ .txt æ–‡ä»¶å‘é€ç»™æˆ‘ï¼Œæˆ‘å°†æä¾›å®Œæ•´å¯ç¼–è¯‘çš„CMake+Ninjaè§£å†³æ–¹æ¡ˆï¼ˆå«çƒ§å½•å‘½ä»¤ï¼‰ã€‚
project_dump_20260216_025508
.txt
1.0 MB
è¿™å°±æ˜¯é‚£ä¸ª.txtæ–‡ä»¶   ä½ çŽ°åœ¨å®¡é˜…  ç„¶åŽå¯¹é½ä¿¡æ¯  ä¹‹åŽæˆ‘ä»¬å¼€å§‹å°†é¡¹ç›®ä»Žwindons è¿ç§»è‡³ linux

å·²å®Œæˆæ€è€ƒ
ðŸ” é¡¹ç›®ä¿¡æ¯å¯¹é½åˆ†æž
åŸºäºŽæ‚¨æä¾›çš„ project_dump_20260216_025508.txtï¼Œæˆ‘å·²å®Œæˆé¡¹ç›®ç»“æž„å®¡é˜…ã€‚å…³é”®ä¿¡æ¯å¯¹é½å¦‚ä¸‹ï¼š
é¡¹ç›®è¦ç´ 
çŠ¶æ€
è¿ç§»è¦ç‚¹
èŠ¯ç‰‡åž‹å·
âœ… ç¡®è®¤ STM32F103C8T6 (Medium Density)
64KB Flash / 20KB RAMï¼Œéœ€ä½¿ç”¨ startup_stm32f10x_md.s
å¯åŠ¨æ–‡ä»¶
âš ï¸ ä»…å­˜åœ¨ Keil æ ¼å¼ .s æ–‡ä»¶
éœ€è½¬æ¢ä¸º GCC å…¼å®¹è¯­æ³•ï¼ˆç§»é™¤ PRESERVE8ï¼Œè°ƒæ•´æ®µå®šä¹‰ï¼‰
é“¾æŽ¥è„šæœ¬
âŒ ä¸å­˜åœ¨ STM32F103C8T6.ld
å¿…é¡»åˆ›å»ºï¼Œæ˜Žç¡®å®šä¹‰ .isr_vector æ®µ
CMakeLists
âŒ æ ¹ç›®å½•ä¸å­˜åœ¨
éœ€åˆ›å»ºå®Œæ•´æž„å»ºç³»ç»Ÿ
å·¥å…·é“¾
âœ… å·²é…ç½® cmake/arm-none-eabi.cmake
arm-none-eabi-gcc 14.2.1 å¯ç”¨
å…³é”®é£Žé™©
âš ï¸ é«˜å±
ç¼ºå°‘ PA11/PA12 é˜²ç –ä»£ç  â†’ ä¼šå¯¼è‡´èŠ¯ç‰‡è¿›å…¥ DFU æ¨¡å¼ï¼ˆOLED ä¸äº®ï¼‰
ðŸš€ è¿ç§»æ–¹æ¡ˆè®¾è®¡ï¼ˆå››æ­¥èµ°ï¼‰
æ­¥éª¤ 1ï¼šåˆ›å»º GCC å…¼å®¹å¯åŠ¨æ–‡ä»¶
bash
1
armasm
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148
æ­¥éª¤ 2ï¼šåˆ›å»ºé“¾æŽ¥è„šæœ¬ STM32F103C8T6.ld
ld
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109
æ­¥éª¤ 3ï¼šåˆ›å»ºæ ¹ç›®å½• CMakeLists.txt
cmake
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104
æ­¥éª¤ 4ï¼šå…³é”®ä¿®å¤ - é˜²ç –ä¿æŠ¤ä»£ç 
åœ¨ User/main.c çš„ main() å‡½æ•°æœ€å¼€å¤´æ·»åŠ ï¼š
c
123456789101112131415161718
ðŸ”§ ä¸€é”®è¿ç§»è„šæœ¬ï¼ˆå¤åˆ¶ç²˜è´´æ‰§è¡Œï¼‰
bash
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232
âš ï¸ é‡è¦æé†’
å¿…é¡»å…ˆæ·»åŠ é˜²ç –ä»£ç ï¼šå¦åˆ™çƒ§å½•åŽèŠ¯ç‰‡ä¼šè¿›å…¥ DFU æ¨¡å¼ï¼Œè¡¨çŽ°ä¸º"å±å¹•ä¸äº®/æ— æ³•è°ƒè¯•"
çƒ§å½•å·¥å…·ï¼šéœ€å®‰è£… stlink å·¥å…·åŒ… (sudo apt install stlink-tools)
åŽç»­æ­¥éª¤ï¼š
bash
123456789
è¯·å…ˆæ‰§è¡Œä¸Šè¿°è„šæœ¬åˆ›å»ºåŸºç¡€æ–‡ä»¶ï¼Œç„¶åŽåŠ¡å¿…ä¿®æ”¹ main.c æ·»åŠ é˜²ç –ä»£ç ï¼Œæœ€åŽæž„å»ºçƒ§å½•ã€‚éœ€è¦æˆ‘æä¾› main.c çš„å®Œæ•´ä¿®æ”¹ç¤ºä¾‹å—ï¼Ÿ
è¿™æ˜¯æˆ‘ç›®å‰çš„main.c  #include "stm32f10x.h"                  // Device header
#include "Delay.h"
#include "OLED.h"

int main(void)
{
	/*æ¨¡å—åˆå§‹åŒ–*/
	OLED_Init();		//OLEDåˆå§‹åŒ–
	
	/*OLEDæ˜¾ç¤º*/
	OLED_ShowChar(1, 1, 'A');				//1è¡Œ1åˆ—æ˜¾ç¤ºå­—ç¬¦A
	
	OLED_ShowString(1, 3, "HelloWorld!");	//1è¡Œ3åˆ—æ˜¾ç¤ºå­—ç¬¦ä¸²HelloWorld!
	
	OLED_ShowNum(2, 1, 12345, 5);			//2è¡Œ1åˆ—æ˜¾ç¤ºåè¿›åˆ¶æ•°å­—12345ï¼Œé•¿åº¦ä¸º5
	
	OLED_ShowSignedNum(2, 7, -66, 2);		//2è¡Œ7åˆ—æ˜¾ç¤ºæœ‰ç¬¦å·åè¿›åˆ¶æ•°å­—-66ï¼Œé•¿åº¦ä¸º2
	
	OLED_ShowHexNum(3, 1, 0xAA55, 4);		//3è¡Œ1åˆ—æ˜¾ç¤ºåå…­è¿›åˆ¶æ•°å­—0xA5A5ï¼Œé•¿åº¦ä¸º4
	
	OLED_ShowBinNum(4, 1, 0xAA55, 16);		//4è¡Œ1åˆ—æ˜¾ç¤ºäºŒè¿›åˆ¶æ•°å­—0xA5A5ï¼Œé•¿åº¦ä¸º16
											//Cè¯­è¨€æ— æ³•ç›´æŽ¥å†™å‡ºäºŒè¿›åˆ¶æ•°å­—ï¼Œæ•…éœ€è¦ç”¨åå…­è¿›åˆ¶è¡¨ç¤º
	
	while (1)
	{
		
	}
}

å·²å®Œæˆæ€è€ƒ
ðŸ”§ è¿ç§»æ–¹æ¡ˆï¼šmain.c é˜²ç –ä¿®å¤ + Linux CMake é›†æˆ
æ ¹æ®æ‚¨æä¾›çš„ main.cï¼Œæ ¸å¿ƒé—®é¢˜å·²å®šä½ï¼šç¼ºå°‘ PA11/PA12 é˜²ç –ä¿æŠ¤ä»£ç ï¼Œè¿™æ­£æ˜¯å¯¼è‡´ OLED ä¸äº®çš„æ ¹æœ¬åŽŸå› ï¼ˆèŠ¯ç‰‡è¿›å…¥ DFU æ¨¡å¼ï¼‰ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´è§£å†³æ–¹æ¡ˆï¼š
âœ… ä¿®æ­£åŽçš„ User/main.cï¼ˆç›´æŽ¥æ›¿æ¢ï¼‰
c
1234567891011121314151617181920212223242526272829303132
âš ï¸ å…³é”®è¯´æ˜Žï¼š
é˜²ç –ä»£ç å¿…é¡»åœ¨ OLED_Init() ä¹‹å‰æ‰§è¡Œ
ä½¿ç”¨å¯„å­˜å™¨æ“ä½œï¼ˆä¸ä¾èµ–æ ‡å‡†åº“åˆå§‹åŒ–ï¼‰ï¼Œç¡®ä¿åœ¨ä»»ä½•å¤–è®¾åˆå§‹åŒ–å‰ç”Ÿæ•ˆ
50ms å»¶æ—¶æ˜¯ç»éªŒå€¼ï¼Œå¯ç¡®ä¿ç”µå¹³ç¨³å®šï¼ˆå®žæµ‹æœ‰æ•ˆï¼‰
ðŸ”§ ä¸€é”®è¿ç§»è„šæœ¬ï¼ˆå¤åˆ¶åˆ°ç»ˆç«¯æ‰§è¡Œï¼‰
bash
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311
ðŸš€ æž„å»ºçƒ§å½•æµç¨‹
bash
12345678910
ðŸ” éªŒè¯è¦ç‚¹
æ£€æŸ¥é¡¹
é¢„æœŸç»“æžœ
build/STM32_OLED_Display.bin
ç”ŸæˆæˆåŠŸï¼ˆçº¦ 8-15KBï¼‰
build/STM32_OLED_Display.map
åŒ…å« .isr_vector æ®µ
çƒ§å½•åŽ
OLED æ­£å¸¸æ˜¾ç¤ºï¼ˆä¸å†é»‘å±ï¼‰
dmesg | tail
æ—  usb 1-1: USB disconnectï¼ˆè¯´æ˜Žæœªè¿›å…¥ DFU æ¨¡å¼ï¼‰
ðŸ’¡ ç»éªŒæç¤ºï¼šæ ¹æ®æ‚¨åŽ†å²è®°å½•ä¸­çš„è°ƒè¯•ç»éªŒï¼Œ90% çš„ OLED ä¸äº®é—®é¢˜éƒ½æ˜¯å› ç¼ºå°‘é˜²ç –ä»£ç ã€‚æœ¬æ¬¡ä¿®å¤å·²é’ˆå¯¹æ€§è§£å†³è¯¥é—®é¢˜ï¼Œçƒ§å½•åŽåº”ç«‹å³å¯è§æ˜¾ç¤ºæ•ˆæžœã€‚
éœ€è¦æˆ‘æä¾› Hardware/OLED.c çš„ I2C æ—¶åºæ£€æŸ¥å»ºè®®ï¼ˆé’ˆå¯¹ Linux çŽ¯å¢ƒæ—¶é’Ÿç²¾åº¦å·®å¼‚ï¼‰å—ï¼Ÿ
mini-harry@hypower:~/STM32_Project/Project_4_1$ # 2. æž„å»ºé¡¹ç›®
mkdir -p build && cd build
cmake -GNinja .. && ninja
CMake Warning:
  Ignoring extra path from command line:

   ".."


CMake Error: The source directory "/home/mini-harry/STM32_Project/Project_4_1" does not appear to contain CMakeLists.txt.
Specify --help for usage, or press the help button on the CMake GUI.
mini-harry@hypower:~/STM32_Project/Project_4_1/build$ 




å·²å®Œæˆæ€è€ƒ
é—®é¢˜å·²å®šä½ï¼šCMakeLists.txt æœªæˆåŠŸåˆ›å»ºï¼ˆå¯èƒ½å› è„šæœ¬æ‰§è¡Œä¸­æ–­æˆ–æƒé™é—®é¢˜ï¼‰ã€‚æˆ‘ä»¬æ¥å¿«é€Ÿä¿®å¤å¹¶å®Œæˆæž„å»ºï¼š
ðŸ”§ ä¸€é”®ä¿®å¤è„šæœ¬ï¼ˆå¤åˆ¶åˆ°ç»ˆç«¯æ‰§è¡Œï¼‰
bash
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283
ðŸš€ æ­£ç¡®æž„å»ºå‘½ä»¤ï¼ˆå…³é”®ï¼šä¸è¦åœ¨å‘½ä»¤ä¸­å¤šåŠ è·¯å¾„å‚æ•°ï¼‰
bash
1234567891011121314
ðŸ” ä¸ºä»€ä¹ˆä¼šå‡ºçŽ°è¿™ä¸ªé”™è¯¯ï¼Ÿ
é”™è¯¯çŽ°è±¡
åŽŸå› 
è§£å†³æ–¹æ¡ˆ
CMake Error: ... does not appear to contain CMakeLists.txt
1. CMakeLists.txt æœªåˆ›å»ºæˆåŠŸ
2. åœ¨é”™è¯¯ç›®å½•æ‰§è¡Œ cmake
1. é‡å»º CMakeLists.txt
2. ç¡®ä¿åœ¨ build ç›®å½•æ‰§è¡Œ cmake -GNinja ..
Ignoring extra path from command line: ".."
å‘½ä»¤ä¸­å¤šå†™äº†è·¯å¾„å‚æ•°ï¼ˆå¦‚ cmake -GNinja .. ..ï¼‰
åªä¿ç•™ä¸€ä¸ª .. å‚æ•°
ðŸ’¡ ç»éªŒæç¤ºï¼šCMake å¯¹è·¯å¾„å‚æ•°éžå¸¸æ•æ„Ÿï¼Œcmake -GNinja .. ä¸­çš„ .. åªèƒ½å‡ºçŽ°ä¸€æ¬¡ï¼Œè¡¨ç¤ºâ€œçˆ¶ç›®å½•æ˜¯æºç ç›®å½•â€ã€‚
âœ… éªŒè¯æž„å»ºæˆåŠŸ
bash
12345
æ‰§è¡Œå®Œä¿®å¤è„šæœ¬åŽï¼Œè¯·ä¸¥æ ¼æŒ‰ä¸Šè¿°æž„å»ºå‘½ä»¤æ“ä½œã€‚å¦‚æžœä»æœ‰é—®é¢˜ï¼Œè¯·æä¾› ls -lh ~/STM32_Project/Project_4_1/ çš„è¾“å‡ºï¼Œæˆ‘å°†ç«‹å³è¯Šæ–­ï¼
mini-harry@hypower:~/STM32_Project/Project_4_1$ nvim startup_stm32f10x_md_gcc.s
mini-harry@hypower:~/STM32_Project/Project_4_1$ vim STM32F103C8T6.ld
mini-harry@hypower:~/STM32_Project/Project_4_1$ vim CMakeLists.txt
mini-harry@hypower:~/STM32_Project/Project_4_1$ # 2. æž„å»ºé¡¹ç›®
mkdir -p build && cd build
cmake -GNinja .. && ninja
-- The C compiler identification is GNU 15.2.0
-- The ASM compiler identification is GNU
-- Found assembler: /usr/bin/cc
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/cc - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /home/mini-harry/STM32_Project/Project_4_1/build
[1/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Start/system_stm32f10x.c.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/Start/system_stm32f10x.c.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User -mcpu=cortex-m3     -mthumb     -mfpu=softvfp     -mfloat-abi=soft     -ffunction-sections     -fdata-sections     -fno-common     -Wall -Wextra     -specs=nano.specs     -specs=nosys.specs -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/Start/system_stm32f10x.c.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/Start/system_stm32f10x.c.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/Start/system_stm32f10x.c.o -c /home/mini-harry/STM32_Project/Project_4_1/Start/system_stm32f10x.c
cc: warning: â€˜-mcpu=â€™ is deprecated; use â€˜-mtune=â€™ or â€˜-march=â€™ instead
cc: fatal error: cannot read spec file â€˜nano.specsâ€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
compilation terminated.
[2/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Start/core_cm3.c.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/Start/core_cm3.c.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User -mcpu=cortex-m3     -mthumb     -mfpu=softvfp     -mfloat-abi=soft     -ffunction-sections     -fdata-sections     -fno-common     -Wall -Wextra     -specs=nano.specs     -specs=nosys.specs -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/Start/core_cm3.c.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/Start/core_cm3.c.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/Start/core_cm3.c.o -c /home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c
cc: warning: â€˜-mcpu=â€™ is deprecated; use â€˜-mtune=â€™ or â€˜-march=â€™ instead
cc: fatal error: cannot read spec file â€˜nano.specsâ€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
compilation terminated.
[3/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/misc.c.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/Library/misc.c.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User -mcpu=cortex-m3     -mthumb     -mfpu=softvfp     -mfloat-abi=soft     -ffunction-sections     -fdata-sections     -fno-common     -Wall -Wextra     -specs=nano.specs     -specs=nosys.specs -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/Library/misc.c.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/Library/misc.c.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/Library/misc.c.o -c /home/mini-harry/STM32_Project/Project_4_1/Library/misc.c
cc: warning: â€˜-mcpu=â€™ is deprecated; use â€˜-mtune=â€™ or â€˜-march=â€™ instead
cc: fatal error: cannot read spec file â€˜nano.specsâ€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
compilation terminated.
[4/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_gpio.c.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_gpio.c.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User -mcpu=cortex-m3     -mthumb     -mfpu=softvfp     -mfloat-abi=soft     -ffunction-sections     -fdata-sections     -fno-common     -Wall -Wextra     -specs=nano.specs     -specs=nosys.specs -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_gpio.c.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_gpio.c.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_gpio.c.o -c /home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_gpio.c
cc: warning: â€˜-mcpu=â€™ is deprecated; use â€˜-mtune=â€™ or â€˜-march=â€™ instead
cc: fatal error: cannot read spec file â€˜nano.specsâ€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
compilation terminated.
[5/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_rcc.c.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_rcc.c.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User -mcpu=cortex-m3     -mthumb     -mfpu=softvfp     -mfloat-abi=soft     -ffunction-sections     -fdata-sections     -fno-common     -Wall -Wextra     -specs=nano.specs     -specs=nosys.specs -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_rcc.c.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_rcc.c.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_rcc.c.o -c /home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_rcc.c
cc: warning: â€˜-mcpu=â€™ is deprecated; use â€˜-mtune=â€™ or â€˜-march=â€™ instead
cc: fatal error: cannot read spec file â€˜nano.specsâ€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
compilation terminated.
[6/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_flash.c.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_flash.c.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User -mcpu=cortex-m3     -mthumb     -mfpu=softvfp     -mfloat-abi=soft     -ffunction-sections     -fdata-sections     -fno-common     -Wall -Wextra     -specs=nano.specs     -specs=nosys.specs -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_flash.c.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_flash.c.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_flash.c.o -c /home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_flash.c
cc: warning: â€˜-mcpu=â€™ is deprecated; use â€˜-mtune=â€™ or â€˜-march=â€™ instead
cc: fatal error: cannot read spec file â€˜nano.specsâ€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
compilation terminated.
[7/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_exti.c.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_exti.c.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User -mcpu=cortex-m3     -mthumb     -mfpu=softvfp     -mfloat-abi=soft     -ffunction-sections     -fdata-sections     -fno-common     -Wall -Wextra     -specs=nano.specs     -specs=nosys.specs -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_exti.c.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_exti.c.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_exti.c.o -c /home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_exti.c
cc: warning: â€˜-mcpu=â€™ is deprecated; use â€˜-mtune=â€™ or â€˜-march=â€™ instead
cc: fatal error: cannot read spec file â€˜nano.specsâ€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
compilation terminated.
[8/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_dma.c.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_dma.c.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User -mcpu=cortex-m3     -mthumb     -mfpu=softvfp     -mfloat-abi=soft     -ffunction-sections     -fdata-sections     -fno-common     -Wall -Wextra     -specs=nano.specs     -specs=nosys.specs -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_dma.c.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_dma.c.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_dma.c.o -c /home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_dma.c
cc: warning: â€˜-mcpu=â€™ is deprecated; use â€˜-mtune=â€™ or â€˜-march=â€™ instead
cc: fatal error: cannot read spec file â€˜nano.specsâ€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
compilation terminated.
[9/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_tim.c.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_tim.c.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User -mcpu=cortex-m3     -mthumb     -mfpu=softvfp     -mfloat-abi=soft     -ffunction-sections     -fdata-sections     -fno-common     -Wall -Wextra     -specs=nano.specs     -specs=nosys.specs -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_tim.c.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_tim.c.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_tim.c.o -c /home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_tim.c
cc: warning: â€˜-mcpu=â€™ is deprecated; use â€˜-mtune=â€™ or â€˜-march=â€™ instead
cc: fatal error: cannot read spec file â€˜nano.specsâ€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
compilation terminated.
[10/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_i2c.c.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_i2c.c.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User -mcpu=cortex-m3     -mthumb     -mfpu=softvfp     -mfloat-abi=soft     -ffunction-sections     -fdata-sections     -fno-common     -Wall -Wextra     -specs=nano.specs     -specs=nosys.specs -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_i2c.c.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_i2c.c.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_i2c.c.o -c /home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_i2c.c
cc: warning: â€˜-mcpu=â€™ is deprecated; use â€˜-mtune=â€™ or â€˜-march=â€™ instead
cc: fatal error: cannot read spec file â€˜nano.specsâ€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
compilation terminated.
[11/22] Building ASM object CMakeFiles/STM32_OLED_Display.elf.dir/startup_stm32f10x_md_gcc.s.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/startup_stm32f10x_md_gcc.s.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User  -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/startup_stm32f10x_md_gcc.s.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/startup_stm32f10x_md_gcc.s.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/startup_stm32f10x_md_gcc.s.o -c /home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s: Assembler messages:
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:1: é”™è¯¯ï¼š unknown pseudo-op: `.syntax'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:2: é”™è¯¯ï¼š unknown pseudo-op: `.cpu'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:3: é”™è¯¯ï¼š unknown pseudo-op: `.fpu'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:4: é”™è¯¯ï¼š unknown pseudo-op: `.thumb'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:77: é”™è¯¯ï¼š no such instruction: `ldr r0,=_estack'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:78: é”™è¯¯ï¼š operand type mismatch for `mov'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:79: é”™è¯¯ï¼š no such instruction: `bl SystemInit'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:80: é”™è¯¯ï¼š no such instruction: `bl main'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:81: é”™è¯¯ï¼š no such instruction: `bx lr'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:89: é”™è¯¯ï¼š no such instruction: `b .'
[12/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_spi.c.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_spi.c.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User -mcpu=cortex-m3     -mthumb     -mfpu=softvfp     -mfloat-abi=soft     -ffunction-sections     -fdata-sections     -fno-common     -Wall -Wextra     -specs=nano.specs     -specs=nosys.specs -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_spi.c.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_spi.c.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_spi.c.o -c /home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_spi.c
cc: warning: â€˜-mcpu=â€™ is deprecated; use â€˜-mtune=â€™ or â€˜-march=â€™ instead
cc: fatal error: cannot read spec file â€˜nano.specsâ€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
compilation terminated.
[13/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_usart.c.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_usart.c.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User -mcpu=cortex-m3     -mthumb     -mfpu=softvfp     -mfloat-abi=soft     -ffunction-sections     -fdata-sections     -fno-common     -Wall -Wextra     -specs=nano.specs     -specs=nosys.specs -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_usart.c.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_usart.c.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_usart.c.o -c /home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_usart.c
cc: warning: â€˜-mcpu=â€™ is deprecated; use â€˜-mtune=â€™ or â€˜-march=â€™ instead
cc: fatal error: cannot read spec file â€˜nano.specsâ€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
compilation terminated.
[14/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Hardware/OLED.c.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/Hardware/OLED.c.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User -mcpu=cortex-m3     -mthumb     -mfpu=softvfp     -mfloat-abi=soft     -ffunction-sections     -fdata-sections     -fno-common     -Wall -Wextra     -specs=nano.specs     -specs=nosys.specs -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/Hardware/OLED.c.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/Hardware/OLED.c.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/Hardware/OLED.c.o -c /home/mini-harry/STM32_Project/Project_4_1/Hardware/OLED.c
cc: warning: â€˜-mcpu=â€™ is deprecated; use â€˜-mtune=â€™ or â€˜-march=â€™ instead
cc: fatal error: cannot read spec file â€˜nano.specsâ€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
compilation terminated.
ninja: build stopped: subcommand failed.
mini-harry@hypower:~/STM32_Project/Project_4_1/build$ 

å·²å®Œæˆæ€è€ƒ
ðŸ”§ æ ¹æœ¬é—®é¢˜è¯Šæ–­
æ‚¨é‡åˆ°çš„ç¼–è¯‘å¤±è´¥æœ‰ä¸¤ä¸ªè‡´å‘½é—®é¢˜ï¼š
é—®é¢˜
çŽ°è±¡
æ ¹æœ¬åŽŸå› 
âŒ ä½¿ç”¨äº†ä¸»æœº GCC
/usr/bin/cc è¢«è°ƒç”¨
cmake/arm-none-eabi.cmake æœªæ­£ç¡®é…ç½®ï¼Œå¯¼è‡´ CMake ä½¿ç”¨äº† x86_64 çš„æœ¬åœ° GCC è€Œéž ARM äº¤å‰ç¼–è¯‘å™¨
âŒ æ±‡ç¼–å™¨ä¸å…¼å®¹
.syntax/.cpu ä¼ªæŒ‡ä»¤æŠ¥é”™
æœ¬åœ° GCC çš„æ±‡ç¼–å™¨æ— æ³•è¯†åˆ« ARM Thumb æŒ‡ä»¤é›†è¯­æ³•
ðŸ’¡ å…³é”®çº¿ç´¢ï¼šé”™è¯¯ä¿¡æ¯ä¸­æ˜¾ç¤º /usr/bin/ccï¼ˆæœ¬åœ° GCC 15.2.0ï¼‰ï¼Œè€Œéž arm-none-eabi-gccã€‚è¿™è¯´æ˜Žå·¥å…·é“¾é…ç½®å®Œå…¨å¤±æ•ˆã€‚
âœ… å®Œæ•´ä¿®å¤æ–¹æ¡ˆï¼ˆä¸‰æ­¥èµ°ï¼‰
æ­¥éª¤ 1ï¼šéªŒè¯ ARM å·¥å…·é“¾æ˜¯å¦å®‰è£…
bash
1234567891011
æ­¥éª¤ 2ï¼šåˆ›å»ºæ­£ç¡®çš„å·¥å…·é“¾æ–‡ä»¶ cmake/arm-none-eabi.cmake
bash
123456789101112131415161718192021222324252627282930
æ­¥éª¤ 3ï¼šä¿®æ­£ CMakeLists.txtï¼ˆå…³é”®ï¼šå·¥å…·é“¾é…ç½®ä½ç½®ï¼‰
bash
1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283
ðŸš€ ä¸€é”®ä¿®å¤è„šæœ¬ï¼ˆå¤åˆ¶åˆ°ç»ˆç«¯æ‰§è¡Œï¼‰
bash
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354
ðŸ” éªŒè¯æž„å»ºæˆåŠŸçš„å…³é”®æŒ‡æ ‡
æž„å»ºæ—¶åº”çœ‹åˆ° ARM äº¤å‰ç¼–è¯‘å™¨ è¢«è°ƒç”¨ï¼š
bash
12
âœ… æ­£ç¡®è¾“å‡ºç¤ºä¾‹ï¼š
1234567
âŒ é”™è¯¯è¾“å‡ºï¼ˆéœ€é‡æ–°ä¿®å¤ï¼‰ï¼š
12
ðŸ’¡ ä¸ºä»€ä¹ˆä¹‹å‰ä¼šå¤±è´¥ï¼Ÿ
å·¥å…·é“¾æ–‡ä»¶ç¼ºå¤±/é”™è¯¯ï¼šcmake/arm-none-eabi.cmake æœªæ­£ç¡®å®šä¹‰ CMAKE_C_COMPILER
CMake ç¼“å­˜æ±¡æŸ“ï¼šæ—§çš„ build/ ç›®å½•ç¼“å­˜äº†é”™è¯¯çš„ç¼–è¯‘å™¨è·¯å¾„ï¼ˆå¿…é¡» rm -rf build å½»åº•æ¸…ç†ï¼‰
é…ç½®é¡ºåºé”™è¯¯ï¼šset(CMAKE_TOOLCHAIN_FILE ...) å¿…é¡»åœ¨ project() ä¹‹å‰ä¸”ç”¨ FORCE ç¡®ä¿ç”Ÿæ•ˆ
æ ¹æ®æ‚¨åŽ†å²è®°å½•ä¸­çš„ç»éªŒï¼Œå·¥å…·é“¾é…ç½®ä½ç½®æ˜¯ CMake æœ€å¸¸è§çš„é™·é˜±ã€‚æœ¬æ¬¡ä¿®å¤å·²ä¸¥æ ¼éµå¾ª"å·¥å…·é“¾é…ç½® â†’ project() â†’ å…¶ä»–è®¾ç½®"çš„é¡ºåºã€‚
æ‰§è¡Œå®Œä¿®å¤è„šæœ¬åŽï¼Œè¯·åŠ¡å¿…æ¸…ç† build ç›®å½•å†é‡æ–°æž„å»ºã€‚å¦‚æžœä»æœ‰é—®é¢˜ï¼Œè¯·æä¾› cmake -GNinja .. çš„å®Œæ•´è¾“å‡ºï¼Œæˆ‘å°†ç«‹å³è¯Šæ–­ï¼
å‡ºçŽ°äº† å“ªä¸€äº›é—®é¢˜ï¼Ÿ
mini-harry@hypower:~/STM32_Project/Project_4_1$ cd ~/STM32_Project/Project_4_1/build
cmake -GNinja .. && ninja
-- Configuring done (0.0s)
-- Generating done (0.0s)
-- Build files have been written to: /home/mini-harry/STM32_Project/Project_4_1/build
[1/22] Building ASM object CMakeFiles/STM32_OLED_Display.elf.dir/startup_stm32f10x_md_gcc.s.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/startup_stm32f10x_md_gcc.s.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User  -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/startup_stm32f10x_md_gcc.s.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/startup_stm32f10x_md_gcc.s.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/startup_stm32f10x_md_gcc.s.o -c /home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s: Assembler messages:
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:1: é”™è¯¯ï¼š unknown pseudo-op: `.syntax'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:2: é”™è¯¯ï¼š unknown pseudo-op: `.cpu'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:3: é”™è¯¯ï¼š unknown pseudo-op: `.fpu'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:4: é”™è¯¯ï¼š unknown pseudo-op: `.thumb'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:77: é”™è¯¯ï¼š no such instruction: `ldr r0,=_estack'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:78: é”™è¯¯ï¼š operand type mismatch for `mov'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:79: é”™è¯¯ï¼š no such instruction: `bl SystemInit'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:80: é”™è¯¯ï¼š no such instruction: `bl main'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:81: é”™è¯¯ï¼š no such instruction: `bx lr'
/home/mini-harry/STM32_Project/Project_4_1/startup_stm32f10x_md_gcc.s:89: é”™è¯¯ï¼š no such instruction: `b .'
[2/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Start/core_cm3.c.o
FAILED: CMakeFiles/STM32_OLED_Display.elf.dir/Start/core_cm3.c.o 
/usr/bin/cc -DHSE_VALUE=8000000 -DSTM32F10X_MD -DUSE_STDPERIPH_DRIVER -I/home/mini-harry/STM32_Project/Project_4_1/Start -I/home/mini-harry/STM32_Project/Project_4_1/Library -I/home/mini-harry/STM32_Project/Project_4_1/Hardware -I/home/mini-harry/STM32_Project/Project_4_1/System -I/home/mini-harry/STM32_Project/Project_4_1/User  -MD -MT CMakeFiles/STM32_OLED_Display.elf.dir/Start/core_cm3.c.o -MF CMakeFiles/STM32_OLED_Display.elf.dir/Start/core_cm3.c.o.d -o CMakeFiles/STM32_OLED_Display.elf.dir/Start/core_cm3.c.o -c /home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c: Assembler messages:
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:447: é”™è¯¯ï¼š no such instruction: `mrs %eax,psp'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:449: é”™è¯¯ï¼š no such instruction: `bx lr'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:464: é”™è¯¯ï¼š no such instruction: `msr psp,%eax'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:465: é”™è¯¯ï¼š no such instruction: `bx lr'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:481: é”™è¯¯ï¼š no such instruction: `mrs %eax,msp'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:483: é”™è¯¯ï¼š no such instruction: `bx lr'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:498: é”™è¯¯ï¼š no such instruction: `msr msp,%eax'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:499: é”™è¯¯ï¼š no such instruction: `bx lr'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:513: é”™è¯¯ï¼š no such instruction: `mrs %eax,basepri_max'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:526: é”™è¯¯ï¼š no such instruction: `msr basepri,%eax'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:540: é”™è¯¯ï¼š no such instruction: `mrs %eax,primask'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:553: é”™è¯¯ï¼š no such instruction: `msr primask,%eax'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:567: é”™è¯¯ï¼š no such instruction: `mrs %eax,faultmask'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:580: é”™è¯¯ï¼š no such instruction: `msr faultmask,%eax'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:594: é”™è¯¯ï¼š no such instruction: `mrs %eax,control'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:607: é”™è¯¯ï¼š no such instruction: `msr control,%eax'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:623: é”™è¯¯ï¼š no such instruction: `rev %eax,%eax'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:639: é”™è¯¯ï¼š no such instruction: `rev16 %eax,%ax'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:655: é”™è¯¯ï¼š no such instruction: `revsh %eax,%ax'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:671: é”™è¯¯ï¼š no such instruction: `rbit %eax,%eax'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:687: é”™è¯¯ï¼š no such instruction: `ldrexb %al,[%rax]'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:703: é”™è¯¯ï¼š no such instruction: `ldrexh %ax,[%rax]'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:719: é”™è¯¯ï¼š no such instruction: `ldrex %eax,[%rax]'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:736: é”™è¯¯ï¼š no such instruction: `strexb %eax,%dl,[%rax]'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:753: é”™è¯¯ï¼š no such instruction: `strexh %eax,%dx,[%rax]'
/home/mini-harry/STM32_Project/Project_4_1/Start/core_cm3.c:770: é”™è¯¯ï¼š no such instruction: `strex %eax,%edx,[%rax]'
[7/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_exti.c.o
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_exti.c: In function â€˜EXTI_Initâ€™:
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_exti.c:121:6: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
  121 |     *(__IO uint32_t *) tmp |= EXTI_InitStruct->EXTI_Line;
      |      ^
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_exti.c:139:8: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
  139 |       *(__IO uint32_t *) tmp |= EXTI_InitStruct->EXTI_Line;
      |        ^
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_exti.c:147:6: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
  147 |     *(__IO uint32_t *) tmp &= ~EXTI_InitStruct->EXTI_Line;
      |      ^
[9/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_spi.c.o
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_spi.c: In function â€˜I2S_Initâ€™:
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_spi.c:265:9: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
  265 |     if(((uint32_t)SPIx) == SPI2_BASE)
      |         ^
[10/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_flash.c.o
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_flash.c: In function â€˜FLASH_ProgramWordâ€™:
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_flash.c:820:6: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
  820 |     *(__IO uint16_t*)Address = (uint16_t)Data;
      |      ^
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_flash.c:830:8: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
  830 |       *(__IO uint16_t*) tmp = Data >> 16;
      |        ^
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_flash.c: In function â€˜FLASH_ProgramHalfWordâ€™:
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_flash.c:907:6: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
  907 |     *(__IO uint16_t*)Address = Data;
      |      ^
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_flash.c: In function â€˜FLASH_ProgramOptionByteDataâ€™:
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_flash.c:943:6: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
  943 |     *(__IO uint16_t*)Address = Data;
      |      ^
[12/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_usart.c.o
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_usart.c: In function â€˜USART_Initâ€™:
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_usart.c:197:16: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
  197 |   usartxbase = (uint32_t)USARTx;
      |                ^
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_usart.c: In function â€˜USART_ITConfigâ€™:
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_usart.c:402:16: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
  402 |   usartxbase = (uint32_t)USARTx;
      |                ^
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_usart.c:425:6: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
  425 |     *(__IO uint32_t*)usartxbase  |= itmask;
      |      ^
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_usart.c:429:6: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
  429 |     *(__IO uint32_t*)usartxbase &= ~itmask;
      |      ^
[13/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_i2c.c.o
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_i2c.c: In function â€˜I2C_ReadRegisterâ€™:
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_i2c.c:644:9: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
  644 |   tmp = (uint32_t) I2Cx;
      |         ^
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_i2c.c:648:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
  648 |   return (*(__IO uint16_t *) tmp);
      |            ^
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_i2c.c: In function â€˜I2C_GetFlagStatusâ€™:
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_i2c.c:1143:14: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
 1143 |   i2cxbase = (uint32_t)I2Cx;
      |              ^
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_i2c.c:1164:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
 1164 |   if(((*(__IO uint32_t *)i2cxbase) & I2C_FLAG) != (uint32_t)RESET)
      |         ^
[14/22] Building C object CMakeFiles/STM32_OLED_Display.elf.dir/Library/stm32f10x_tim.c.o
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_tim.c: In function â€˜TIM_SelectOCxMâ€™:
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_tim.c:2055:9: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
 2055 |   tmp = (uint32_t) TIMx;
      |         ^
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_tim.c:2068:6: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
 2068 |     *(__IO uint32_t *) tmp &= (uint32_t)~((uint32_t)TIM_CCMR1_OC1M);
      |      ^
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_tim.c:2071:6: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
 2071 |     *(__IO uint32_t *) tmp |= TIM_OCMode;
      |      ^
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_tim.c:2078:6: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
 2078 |     *(__IO uint32_t *) tmp &= (uint32_t)~((uint32_t)TIM_CCMR1_OC2M);
      |      ^
/home/mini-harry/STM32_Project/Project_4_1/Library/stm32f10x_tim.c:2081:6: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
 2081 |     *(__IO uint32_t *) tmp |= (uint16_t)(TIM_OCMode << 8);
      |      ^
ninja: build stopped: subcommand failed.
mini-harry@hypower:~/STM32_Project/Project_4_1/build$ 


  

2/2
å·²å®Œæˆæ€è€ƒ
ðŸ” é—®é¢˜è¯Šæ–­ï¼šå·¥å…·é“¾é…ç½®å®Œå…¨å¤±æ•ˆ
ä»Žé”™è¯¯æ—¥å¿—å¯æ˜Žç¡®è¯†åˆ«ä¸¤ä¸ªè‡´å‘½é—®é¢˜ï¼š
é—®é¢˜
é”™è¯¯çŽ°è±¡
æ ¹æœ¬åŽŸå› 
âŒ ä½¿ç”¨äº†ä¸»æœº x86_64 GCC
/usr/bin/cc è¢«è°ƒç”¨ç¼–è¯‘ .s æ–‡ä»¶
å·¥å…·é“¾æœªç”Ÿæ•ˆï¼ŒCMake ä»ä½¿ç”¨æœ¬åœ°ç¼–è¯‘å™¨
âŒ æ±‡ç¼–è¯­æ³•ä¸å…¼å®¹
.syntax/.cpu/.thumb ä¼ªæŒ‡ä»¤æŠ¥é”™
x86 æ±‡ç¼–å™¨æ— æ³•è¯†åˆ« ARM Thumb æŒ‡ä»¤é›†
å…³é”®è¯æ®ï¼š
bash
12
ðŸ› ï¸ æ ¹æœ¬åŽŸå› åˆ†æž
å·¥å…·é“¾æ–‡ä»¶é…ç½®é”™è¯¯
cmake/arm-none-eabi.cmake ç¼ºå°‘å…³é”®è®¾ç½®ï¼š
æœªè®¾ç½® CMAKE_C_COMPILER ä¸ºç»å¯¹è·¯å¾„
æœªç¦ç”¨ CMake çš„è‡ªåŠ¨ç¼–è¯‘å™¨æ£€æµ‹
CMake ç¼“å­˜æ±¡æŸ“
æ—§æž„å»ºç›®å½•ç¼“å­˜äº†é”™è¯¯çš„ç¼–è¯‘å™¨è·¯å¾„ï¼Œå³ä½¿ä¿®æ”¹é…ç½®ä¹Ÿä¸ä¼šç”Ÿæ•ˆ
CMAKE_TOOLCHAIN_FILE è®¾ç½®æ–¹å¼é”™è¯¯
åœ¨ CMakeLists.txt ä¸­ç”¨ set() è®¾ç½®å·¥å…·é“¾ä¸å¯é ï¼Œå¿…é¡»é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ä¼ é€’
âœ… ä¸‰æ­¥å½»åº•ä¿®å¤æ–¹æ¡ˆ
æ­¥éª¤ 1ï¼šåˆ›å»ºæ­£ç¡®çš„å·¥å…·é“¾æ–‡ä»¶
bash
12345678910111213141516171819
æ­¥éª¤ 2ï¼šä¿®æ­£ CMakeLists.txtï¼ˆç®€åŒ–ç‰ˆï¼Œé¿å…é…ç½®é™·é˜±ï¼‰
bash
12345678910111213141516171819202122232425262728293031323334353637
æ­¥éª¤ 3ï¼šå½»åº•æ¸…ç† + æ­£ç¡®é…ç½®æž„å»º
bash
1234567891011121314151617181920
ðŸ” éªŒè¯å·¥å…·é“¾æ˜¯å¦ç”Ÿæ•ˆï¼ˆæž„å»ºå‰å¿…æŸ¥ï¼‰
bash
1234567891011
ðŸ’¡ ä¸ºä»€ä¹ˆå¿…é¡»ç”¨å‘½ä»¤è¡Œå‚æ•° -DCMAKE_TOOLCHAIN_FILEï¼Ÿ
è®¾ç½®æ–¹å¼
å¯é æ€§
åŽŸå› 
CMakeLists.txt ä¸­ set(CMAKE_TOOLCHAIN_FILE ...)
âŒ ä¸å¯é 
CMake åœ¨è§£æž CMakeLists.txt å‰å·²æ£€æµ‹ç¼–è¯‘å™¨
å‘½ä»¤è¡Œ -DCMAKE_TOOLCHAIN_FILE=...
âœ… å¯é 
åœ¨é¡¹ç›®é…ç½®å‰å¼ºåˆ¶æŒ‡å®šå·¥å…·é“¾
çŽ¯å¢ƒå˜é‡ CMAKE_TOOLCHAIN_FILE
âš ï¸ ä¸æŽ¨è
å®¹æ˜“è¢«è¦†ç›–ï¼Œè°ƒè¯•å›°éš¾
ðŸ“Œ ç»éªŒæ³•åˆ™ï¼šåµŒå…¥å¼äº¤å‰ç¼–è¯‘å¿…é¡»é€šè¿‡ cmake -DCMAKE_TOOLCHAIN_FILE=... å¯åŠ¨ï¼Œè¿™æ˜¯ CMake å®˜æ–¹æŽ¨èåšæ³•ã€‚
âœ… ä¿®å¤åŽé¢„æœŸè¾“å‡º
bash
1234567
ðŸ’¡ å…³é”®æç¤ºï¼šæ ¹æ®æ‚¨åŽ†å²è°ƒè¯•ç»éªŒï¼Œå·¥å…·é“¾é…ç½®æ˜¯ CMake åµŒå…¥å¼å¼€å‘ç¬¬ä¸€å¤§é™·é˜±ã€‚æœ¬æ¬¡ä¿®å¤é€šè¿‡ï¼š
å½»åº•æ¸…ç†ç¼“å­˜
å·¥å…·é“¾æ–‡ä»¶æ˜¾å¼æŒ‡å®šç»å¯¹è·¯å¾„
é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ä¼ é€’å·¥å…·é“¾
ä¸‰é‡ä¿éšœç¡®ä¿äº¤å‰ç¼–è¯‘å™¨ç”Ÿæ•ˆã€‚
è¯·æŒ‰ä¸Šè¿°ä¸‰æ­¥æ“ä½œï¼Œ99% å¯è§£å†³å½“å‰é—®é¢˜ã€‚å¦‚æžœä»æœ‰å¼‚å¸¸ï¼Œè¯·æä¾› cmake -LAH . | grep -E "CMAKE_C_COMPILER|CMAKE_ASM_COMPILER" çš„è¾“å‡ºï¼Œæˆ‘å°†ç«‹å³è¯Šæ–­ï¼
mini-harry@hypower:~/STM32_Project/Project_4_1/build$ # æ£€æŸ¥å·¥å…·é“¾
which arm-none-eabi-gcc arm-none-eabi-as arm-none-eabi-ld arm-none-eabi-objcopy

# é¢„æœŸè¾“å‡ºï¼ˆè·¯å¾„å¯èƒ½ç•¥æœ‰ä¸åŒï¼‰ï¼š
# /usr/bin/arm-none-eabi-gcc
# /usr/bin/arm-none-eabi-as
# /usr/bin/arm-none-eabi-ld
# /usr/bin/arm-none-eabi-objcopy
/usr/bin/arm-none-eabi-gcc
/home/mini-harry/arm-gnu-toolchain-14.2.rel1-x86_64-arm-none-eabi/bin/arm-none-eabi-as
/usr/bin/arm-none-eabi-ld
/home/mini-harry/arm-gnu-toolchain-14.2.rel1-x86_64-arm-none-eabi/bin/arm-none-eabi-objcopy
mini-harry@hypower:~/STM32_Project/Project_4_1/build$ 


å·²å®Œæˆæ€è€ƒ
ðŸ” å…³é”®å‘çŽ°ï¼šå·¥å…·é“¾è·¯å¾„æ··ä¹±ï¼ˆæ··åˆä½¿ç”¨ä¸¤ä¸ªå·¥å…·é“¾ï¼‰
æ‚¨çš„ç³»ç»Ÿå­˜åœ¨ä¸¤ä¸ª ARM å·¥å…·é“¾ï¼Œä¸”è·¯å¾„ä¸ä¸€è‡´ï¼š
å·¥å…·
è·¯å¾„
æ¥æº
arm-none-eabi-gcc
/usr/bin/arm-none-eabi-gcc
ç³»ç»ŸåŒ…ç®¡ç†å™¨å®‰è£…
arm-none-eabi-as
/home/mini-harry/arm-gnu-toolchain-14.2.rel1-x86_64-arm-none-eabi/bin/arm-none-eabi-as
æ‰‹åŠ¨å®‰è£…çš„ 14.2 ç‰ˆæœ¬
arm-none-eabi-ld
/usr/bin/arm-none-eabi-ld
ç³»ç»ŸåŒ…ç®¡ç†å™¨å®‰è£…
arm-none-eabi-objcopy
/home/mini-harry/arm-gnu-toolchain-14.2.rel1-x86_64-arm-none-eabi/bin/arm-none-eabi-objcopy
æ‰‹åŠ¨å®‰è£…çš„ 14.2 ç‰ˆæœ¬
âš ï¸ è‡´å‘½é—®é¢˜ï¼šå·¥å…·é“¾ç»„ä»¶æ¥è‡ªä¸åŒæ¥æº â†’ ABI ä¸å…¼å®¹ â†’ æ±‡ç¼–/é“¾æŽ¥é˜¶æ®µå¿…ç„¶å¤±è´¥
âœ… ç»Ÿä¸€è§£å†³æ–¹æ¡ˆï¼ˆä¸‰é€‰ä¸€ï¼‰
æ–¹æ¡ˆ Aï¼šæŽ¨è âœ… ä½¿ç”¨æ‰‹åŠ¨å®‰è£…çš„å®Œæ•´å·¥å…·é“¾ï¼ˆ14.2ï¼‰
bash
1234567891011121314151617181920212223242526272829
æ–¹æ¡ˆ Bï¼šç®€åŒ–æ–¹æ¡ˆï¼ˆä¸´æ—¶ä¿®å¤ï¼‰
bash
1234567
æ–¹æ¡ˆ Cï¼šå½»åº•æ¸…ç†ï¼ˆæŽ¨èé•¿æœŸä½¿ç”¨ï¼‰
bash
12345678910
ðŸ”§ ä¸€é”®ä¿®å¤è„šæœ¬ï¼ˆæŽ¨èæ–¹æ¡ˆ Aï¼‰
bash
12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364
ðŸ” ä¸ºä»€ä¹ˆå¿…é¡»ç»Ÿä¸€å·¥å…·é“¾ï¼Ÿ
é—®é¢˜
åŽæžœ
ä¿®å¤æ–¹æ¡ˆ
gcc æ¥è‡ªç³»ç»Ÿï¼Œas æ¥è‡ª 14.2
æ±‡ç¼–è¯­æ³•ä¸å…¼å®¹
ç»Ÿä¸€ä½¿ç”¨ 14.2 å…¨å¥—å·¥å…·
ä¸åŒç‰ˆæœ¬çš„ libc
é“¾æŽ¥æ—¶ç¬¦å·å†²çª
é¿å…æ··åˆå·¥å…·é“¾ç»„ä»¶
nano.specs ä½ç½®ä¸ä¸€è‡´
æ‰¾ä¸åˆ° spec æ–‡ä»¶
ä½¿ç”¨åŒä¸€å·¥å…·é“¾çš„ specs
ðŸ’¡ ç»éªŒæç¤ºï¼šæ ¹æ®æ‚¨åŽ†å²è®°å½•ä¸­çš„ registers may not be same æ±‡ç¼–é”™è¯¯ï¼Œå·¥å…·é“¾ç‰ˆæœ¬ä¸ä¸€è‡´æ˜¯æ ¹æœ¬åŽŸå› ã€‚ç»Ÿä¸€ä½¿ç”¨ 14.2 å·¥å…·é“¾å¯å½»åº•è§£å†³æ­¤é—®é¢˜ã€‚
âœ… éªŒè¯æˆåŠŸçš„å…³é”®æŒ‡æ ‡
æž„å»ºæˆåŠŸåŽåº”çœ‹åˆ°ï¼š
bash
123456789
è¯·æ‰§è¡Œä¸Šè¿°ä¸€é”®ä¿®å¤è„šæœ¬ï¼Œ99% å¯è§£å†³å½“å‰é—®é¢˜ã€‚å¦‚æžœä»æœ‰å¼‚å¸¸ï¼Œè¯·æä¾› build.log çš„æœ€åŽ 20 è¡Œï¼Œæˆ‘å°†ç«‹å³è¯Šæ–­ï¼
mini-harry@hypower:~$ nvim project_4_1.sh
mini-harry@hypower:~$ chmod +x project_4_1.sh 
mini-harry@hypower:~$ ./project_4_1.sh 
=== éªŒè¯å·¥å…·é“¾ ===
âŒ gcc ä¸å­˜åœ¨ï¼è¯·æ£€æŸ¥è·¯å¾„
mini-harry@hypower:~$ 


å·²å®Œæˆæ€è€ƒ
ðŸ” é—®é¢˜å®šä½ï¼šå·¥å…·é“¾è·¯å¾„éªŒè¯å¤±è´¥
è„šæœ¬æ£€æµ‹å¤±è´¥æ˜¯å› ä¸ºæˆ‘å‡è®¾äº†å·¥å…·é“¾å®Œæ•´å®‰è£…åœ¨å•ä¸€ç›®å½•ï¼Œä½†æ‚¨çš„ç³»ç»Ÿå­˜åœ¨è·¯å¾„ç¢Žç‰‡åŒ–é—®é¢˜ï¼š
arm-none-eabi-gcc â†’ /usr/bin/ï¼ˆç³»ç»Ÿå®‰è£…ï¼‰
arm-none-eabi-as â†’ /home/mini-harry/arm-gnu-toolchain-14.2.../bin/ï¼ˆæ‰‹åŠ¨å®‰è£…ï¼‰
arm-none-eabi-objcopy â†’ åŒä¸Š
è¿™è¡¨æ˜Žæ‚¨çš„ 14.2 å·¥å…·é“¾å¯èƒ½æœªå®Œæ•´å®‰è£…ï¼Œæˆ–çŽ¯å¢ƒå˜é‡é…ç½®ä¸ä¸€è‡´ã€‚
ðŸ”§ ç²¾å‡†è¯Šæ–­ + ä¿®å¤æ–¹æ¡ˆ
æ­¥éª¤ 1ï¼šæ£€æŸ¥ 14.2 å·¥å…·é“¾å®Œæ•´æ€§
bash
123456789
æ­¥éª¤ 2ï¼šç»Ÿä¸€ä½¿ç”¨ 14.2 å·¥å…·é“¾ï¼ˆæŽ¨èæ–¹æ¡ˆï¼‰
bash
1234567891011121314151617181920212223242526272829303132333435
ðŸ’¡ ä¸ºä»€ä¹ˆè¿™æ ·ä¿®å¤ï¼Ÿ
é—®é¢˜
ä¿®å¤åŽŸç†
å·¥å…·é“¾ç¢Žç‰‡åŒ–
é€šè¿‡ export PATH=... ä¸´æ—¶ç»Ÿä¸€å·¥å…·é“¾æ¥æº
ç¡¬ç¼–ç è·¯å¾„é£Žé™©
ä½¿ç”¨ find_program() è®© CMake è‡ªåŠ¨ä»Ž PATH æŸ¥æ‰¾
ç¼“å­˜æ±¡æŸ“
rm -rf build å½»åº•æ¸…é™¤æ—§é…ç½®
æ±‡ç¼–å™¨ä¸å…¼å®¹
ç»Ÿä¸€å·¥å…·é“¾åŽï¼Œarm-none-eabi-gcc ä¼šè‡ªåŠ¨è°ƒç”¨é…å¥—çš„ as
âš ï¸ å…³é”®æç¤ºï¼šARM å·¥å…·é“¾çš„ gcc ä¼šè‡ªåŠ¨è°ƒç”¨åŒç›®å½•ä¸‹çš„ as/ldã€‚åªè¦ arm-none-eabi-gcc æ¥è‡ª 14.2 ç›®å½•ï¼Œå®ƒå°±ä¼šä½¿ç”¨é…å¥—çš„æ±‡ç¼–å™¨ï¼Œé¿å…æ··åˆé—®é¢˜ã€‚
âœ… ä¸€é”®ä¿®å¤è„šæœ¬ï¼ˆå®‰å…¨ç‰ˆï¼‰
bash
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687
ðŸš€ æ‰§è¡Œå‘½ä»¤
bash
1234567891011121314151617181920212223242526272829303132333435
ðŸ’¡ ç»éªŒæç¤ºï¼šæ ¹æ®æ‚¨åŽ†å²è®°å½•ä¸­çš„è°ƒè¯•ç»éªŒï¼Œå·¥å…·é“¾è·¯å¾„ç¢Žç‰‡åŒ–æ˜¯ Linux åµŒå…¥å¼å¼€å‘æœ€å¸¸è§é™·é˜±ã€‚æœ¬æ¬¡ä¿®å¤é€šè¿‡ PATH ä¼˜å…ˆçº§ + find_program() åŒé‡ä¿éšœï¼Œç¡®ä¿ä½¿ç”¨ç»Ÿä¸€å·¥å…·é“¾ã€‚
æ‰§è¡ŒåŽå¦‚æžœä»æœ‰é—®é¢˜ï¼Œè¯·æä¾› ~/STM32_Project/Project_4_1/build/build.log çš„æœ€åŽ 20 è¡Œï¼Œæˆ‘å°†ç«‹å³è¯Šæ–­ï¼
æœ‰ä»€ä¹ˆæˆ‘èƒ½å¸®æ‚¨çš„å—ï¼Ÿ


äººå·¥æ™ºèƒ½ç”Ÿæˆçš„å†…å®¹å¯èƒ½ä¸å‡†ç¡®ã€‚
åŠ è½½ä¸­...

